<div id="mydentist-userreviews"></div>

<script>
  const userreviewsUrl =
    "https://cdn.jsdelivr.net/gh/ArtMooney/mydentist-userreviews@v0.0.1/dist";

  const userreviewsMode = "vertical";

  fetch(userreviewsUrl + "/" + "index.html")
    .then((response) => response.text())
    .then((html) => {
      const parser = new DOMParser();
      const htmlDoc = parser.parseFromString(html, "text/html");

      const scriptSrc = htmlDoc.querySelector("script").getAttribute("src");
      const cssHref = htmlDoc
        .querySelector('link[rel="stylesheet"]')
        .getAttribute("href");

      const scriptElement = document.createElement("script");
      scriptElement.type = "module";
      scriptElement.textContent = `
      import('${bokningswidgetUrl + scriptSrc}')
        .then((module) => {
          module.initialize({
            mode: '${userreviewsMode}',
          });

          const modeEvent = new CustomEvent('modeEvent', {
            detail: mode,
          });
          window.dispatchEvent(modeEvent);
        })
        .catch((error) => {
          console.error('Error importing the module:', error);
        });
      `;

      const linkElement = document.createElement("link");
      linkElement.rel = "stylesheet";
      linkElement.href = userreviewsUrl + cssHref;

      document.head.appendChild(scriptElement);
      document.head.appendChild(linkElement);
    })
    .catch((error) => {
      console.error("Error fetching the file:", error);
    });
</script>
